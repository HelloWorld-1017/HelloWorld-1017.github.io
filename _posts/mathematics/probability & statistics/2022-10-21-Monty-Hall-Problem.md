---
layout: single
title: Monty Hall Problem
date: 2022-10-21 14:17:17 +0800
categories: 
 - Mathematics
tags:
 - Probability Theory and Mathematical Statistics
 - Bayesian Probability
toc: false
---

Monty Hall problem(蒙蒂大厅难题)可能是历史上最有争议的概率问题。问题看似简单，但是正确结果确是有悖常理以至于很多人都无法接受。

Monty Hall是游戏节目“来做个交易”(Let’s Make a Deal)的主场，Monty是主持这个节目的主持人。Monty Hall problem也是这个节目的常规游戏之一，游戏规则是这样的：

- Monty向选手示意三个关闭的大门，然后告诉选手每个门后都有一个奖品：一个奖品是一辆车，另外两个是像花生酱这样不值钱的奖品，奖品随机配置；
- 游戏的目的是要猜哪个门后有车，如果选手猜对了就可以带走汽车；
- 选手首先挑选一扇门，称之为门A，其他两个门称为门B和门C；
- 在选手打开选中的门前，Monty会首先打开门B或者C中没有车的门来增加悬念；
- 之后，蒙蒂会给选手一个选择：是坚持最初的选择(门A)还是换到剩下的未打开的门(B和C中没有打开的门)

**问题是，选手应该选择“坚持”还是“换”？两个选择有没有区别？**

大多数人都有强烈的直觉，认为这没有区别，因为剩下的两个门都没有打开，车在门A背后的机会是50%。但事实上，这种直觉是错误的(在后面也可以看到，在某些情况下可能是正确的)。如果我们利用**贝叶斯思维**来思考这样的问题，会得出结论：如果选手坚持选择门A，那么中奖的概率只有1/3，而如果换到另外一个门，中奖的概率则为2/3。

首先，简单回顾一下贝叶斯定理。贝叶斯定理实际上就是从<u>(1)条件概率定义</u>和<u>(2)全概率公式(依赖于完备事件群的定义)</u>所推导出的：

> **完备事件群(complete events group)**
>
> 设$B_1,B_2,\cdots,B_n$为有限个或无限个事件，它们两两互斥且在每次试验中至少发生一个，即：
> $$
> B_iB_j=\emptyset,\ (i\ne j)\ (不可能事件)\\
> B_1+B_2+\cdots+B_n=\Omega,\ (必然事件)\notag
> $$
> 则把满足上述性质的的一组事件称为一个完备事件群。
>
> **全概率公式(Law of total probability)**
>
> 对于*<u>任一事件</u>*$A$，若$B_1,B_2,\cdots,B_n$为完备事件群，则有：
> $$
> \begin{split}
> P(A)&=P(AB)=P(AB_1+AB_2+\cdots+AB_n)\\
> &=P(AB_1)+P(AB_2)+\cdots+P(AB_n)\\
> &=P(AB_1\vert B_1)P(B_1)+P(A\vert B_2)P(B_2)+\cdots+P(A\vert B_n)P(B_n)
> \end{split}\notag
> $$
> **贝叶斯公式(Bayes Rule)**
>
> 在全概率事件的假定之下，有：
> $$
> \begin{split}
> P(B\vert A)&=\dfrac{P(AB_i)}{P(A)}\\
> &=\dfrac{P(B_i)P(A\vert B_i)}{\sum_jP(B_j)P(A\vert B_j)}
> \end{split}
> $$

首先，我们定义三个假设$H$：A，B和C，分别表示车在门A、门B和门C后面，这三个事件实际上就构成了一个完备事件群。事件D表示Monty打开了门B，后面没有车，于是我们可以采用表格法写出先验概率$P(H)$，似然度$P(D\vert H)$以及后验概率$P(H\vert D)$：

| 假设(事件)H | 先验概率P(H) | 似然度P(D\|H) | P(H)P(D\|H) |   后验概率P(H\|D)   |
| :---------: | :----------: | :-----------: | :---------: | :-----------------: |
|      A      |     1/3      |      1/2      |     1/6     | (1/6)/(1/6+1/3)=1/3 |
|      B      |     1/3      |       0       |      0      |          0          |
|      C      |     1/3      |       1       |     1/3     | (1/3)/(1/6+1/3)=2/3 |

于是我们就得到了上面的结论：如果选手坚持选择门A，那么中奖的概率只有1/3，而如果换到另外一个门，中奖的概率则为2/3。

<br>

Monty Hall problem有很多变形，贝叶斯方法的优势之一就是可以推广到这些变形问题的处理上。其中一个变形问题是：假如主持人Monty在选择开哪一扇门时有明显的偏好，总是尽可能地选择打开门B，只有在汽车真的在门B后才选择门C，那么在这种情况下，仍然使用表格法可以得到：

| 假设(事件)H | 先验概率P(H) | 似然度P(D\|H) | P(H)P(D\|H) | 后验概率P(H\|D) |
| :---------: | :----------: | :-----------: | :---------: | :-------------: |
|      A      |     1/3      |       1       |     1/3     |       1/2       |
|      B      |     1/3      |       0       |      0      |        0        |
|      C      |     1/3      |       1       |     1/3     |       1/2       |

结果是：选手无论选择坚持选择还是更换选择，获得汽车的概率都是相同的，都是1/2。

这个变形问题唯一新增的信息是“Monty在选择打开哪一扇门时总是有倾向于打开门B的偏好”，最终导致结果的不同。

<br>

从这个问题可以看出，贝叶斯定理的确是“**历时诠释**”的：

1）当什么信息也没有时，直接选择并且开门，则中奖概率为$$\dfrac{1}{3}$$;

2）如果Monty打开B门，后面什么也没有，则获取这个信息后，换门中奖概率更高；

3）如果进一步得知Monty总是倾向于打开B门，则得知这个信息后，则无论是否选择换门获奖的概率都是一样的。

从解决这个问题的过程中，似乎也可以看到一丝**博弈论**的味道。比如说如果Monty可以说我总是倾向于选择B门，但实际上是随机选的，如果选手真的信了，则中奖的概率就<u>可能</u>会降低。但是，如果选手始终选择换门，则Monty给出的这个干扰信息就是无用的。

> “当事实改变，我的观念也跟着改变，你呢？”

<br>

**Reference**

[1] Allen B. Downey. 贝叶斯思维: 统计建模的Python学习法. 北京: 人民邮电出版社, 2014.4(2019.5重印).
